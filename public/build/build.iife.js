(function(e){"use strict";const b=(c,t)=>{const s=c.__vccOpts||c;for(const[i,o]of t)s[i]=o;return s},D={class:"codecheck-manifest-files"},C={class:"manifest-files-list"},B=["onUpdate:modelValue"],S=["onUpdate:modelValue"],M=["onClick"],E=b({__name:"CodecheckManifestFiles",props:{name:{type:String,required:!0},label:{type:String,required:!0},description:{type:String,default:""},value:{type:String,default:""},isRequired:{type:Boolean,default:!1}},setup(c){const t=c,s=e.ref([]);e.onMounted(()=>{t.value&&t.value.split(`
`).forEach(n=>{if(n.trim()){const l=n.split(" - ");s.value.push({filename:l[0]||"",comment:l[1]||""})}}),s.value.length===0&&i()});function i(){s.value.push({filename:"",comment:""})}function o(n){s.value.splice(n,1),a()}function a(){var r;const n=s.value.filter(d=>d.filename.trim()).map(d=>d.filename+(d.comment?" - "+d.comment:"")),l=new CustomEvent("update",{detail:n.join(`
`)});(r=document.querySelector(`[data-name="${t.name}"]`))==null||r.dispatchEvent(l)}return(n,l)=>(e.openBlock(),e.createElementBlock("div",D,[e.createElementVNode("div",C,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(s.value,(r,d)=>(e.openBlock(),e.createElementBlock("div",{key:d,class:"manifest-file-row"},[e.withDirectives(e.createElementVNode("input",{"onUpdate:modelValue":h=>r.filename=h,type:"text",placeholder:"Filename (e.g., figures/figure1.png)",onInput:a,class:"form-control"},null,40,B),[[e.vModelText,r.filename]]),e.withDirectives(e.createElementVNode("input",{"onUpdate:modelValue":h=>r.comment=h,type:"text",placeholder:"Comment (e.g., Main result visualization)",onInput:a,class:"form-control"},null,40,S),[[e.vModelText,r.comment]]),e.createElementVNode("button",{type:"button",onClick:h=>o(d),class:"btn-remove"},"Remove",8,M)]))),128))]),e.createElementVNode("button",{type:"button",onClick:i,class:"btn-add"},"+ Add File")]))}},[["__scopeId","data-v-e8d2b036"]]),T={class:"codecheck-repository-list"},I={class:"repository-list"},F=["onUpdate:modelValue"],U=["onClick"],_=b({__name:"CodecheckRepositoryList",props:{name:{type:String,required:!0},label:{type:String,required:!0},description:{type:String,default:""},value:{type:String,default:""}},setup(c){const t=c,s=e.ref([]);e.onMounted(()=>{t.value&&t.value.split(`
`).forEach(n=>{n.trim()&&s.value.push(n.trim())}),s.value.length===0&&i()});function i(){s.value.push("")}function o(n){s.value.splice(n,1),a()}function a(){var r;const n=s.value.filter(d=>d.trim()).join(`
`),l=new CustomEvent("update",{detail:n});(r=document.querySelector(`[data-name="${t.name}"]`))==null||r.dispatchEvent(l)}return(n,l)=>(e.openBlock(),e.createElementBlock("div",T,[e.createElementVNode("div",I,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(s.value,(r,d)=>(e.openBlock(),e.createElementBlock("div",{key:d,class:"repository-row"},[e.withDirectives(e.createElementVNode("input",{"onUpdate:modelValue":h=>s.value[d]=h,type:"text",placeholder:"Repository URL (e.g., https://github.com/username/repo)",onInput:a,class:"form-control"},null,40,F),[[e.vModelText,s.value[d]]]),e.createElementVNode("button",{type:"button",onClick:h=>o(d),class:"btn-remove"},"Remove",8,U)]))),128))]),e.createElementVNode("button",{type:"button",onClick:i,class:"btn-add"},"+ Add Repository")]))}},[["__scopeId","data-v-e9d9bb23"]]),x={class:"codecheck-review-display"},R={key:0,class:"codecheck-info"},L={class:"info-section"},O={key:0,class:"info-section"},A={key:1,class:"info-section"},P={key:2,class:"info-section"},q={key:3,class:"info-section"},j={key:0},z={key:4,class:"info-section"},H={key:0,class:"orcid-badge"},W={key:5,class:"info-section"},Y=["href"],K={key:6,class:"info-section"},J={key:7,class:"info-section"},X={key:8,class:"info-section"},G=["href"],Q={class:"actions"},Z={key:1,class:"codecheck-not-opted"},v=b({__name:"CodecheckReviewDisplay",props:{submission:{type:Object,required:!0}},setup(c){const{useLocalize:t}=pkp.modules.useLocalize,{t:s}=t(),i=c,o=e.computed(()=>{if(i.submission.codecheckMetadata){if(typeof i.submission.codecheckMetadata=="string")try{return JSON.parse(i.submission.codecheckMetadata)}catch(f){return console.error("Failed to parse codecheck metadata:",f),{}}return i.submission.codecheckMetadata}return{}}),a=e.computed(()=>Object.keys(o.value).length>0);function n(){return o.value.certificate&&o.value.checkTime?"complete":a.value?"in-progress":"pending"}const l=e.computed(()=>{switch(n()){case"complete":return"status-complete";case"in-progress":return"status-in-progress";case"pending":default:return"status-pending"}});function r(){switch(n()){case"complete":return s("plugins.generic.codecheck.status.complete");case"in-progress":return s("plugins.generic.codecheck.status.inProgress");case"pending":default:return s("plugins.generic.codecheck.status.pending")}}function d(f){return f?new Date(f).toLocaleString():""}function h(){const f=pkp.registry.getPiniaStore("workflow");f.selectedMenuState={primaryMenuItem:"workflow",stageId:999}}return(f,p)=>{var u;const y=e.resolveComponent("pkp-button");return e.openBlock(),e.createElementBlock("div",x,[e.createElementVNode("h3",null,e.toDisplayString(e.unref(s)("plugins.generic.codecheck.reviewTitle")),1),(u=c.submission)!=null&&u.codecheckOptIn?(e.openBlock(),e.createElementBlock("div",R,[e.createElementVNode("div",L,[e.createElementVNode("h4",null,e.toDisplayString(e.unref(s)("plugins.generic.codecheck.status")),1),e.createElementVNode("span",{class:e.normalizeClass(["status-badge",l.value])},e.toDisplayString(r()),3)]),a.value&&o.value.configVersion?(e.openBlock(),e.createElementBlock("div",O,[e.createElementVNode("h4",null,e.toDisplayString(e.unref(s)("plugins.generic.codecheck.review.configVersion")),1),e.createElementVNode("p",null,e.toDisplayString(o.value.configVersion),1)])):e.createCommentVNode("",!0),a.value&&o.value.publicationType?(e.openBlock(),e.createElementBlock("div",A,[e.createElementVNode("h4",null,e.toDisplayString(e.unref(s)("plugins.generic.codecheck.review.publicationType")),1),e.createElementVNode("p",null,e.toDisplayString(o.value.publicationType==="doi"?e.unref(s)("plugins.generic.codecheck.review.publicationType.doi"):e.unref(s)("plugins.generic.codecheck.review.publicationType.separate")),1)])):e.createCommentVNode("",!0),a.value&&o.value.certificate?(e.openBlock(),e.createElementBlock("div",P,[e.createElementVNode("h4",null,e.toDisplayString(e.unref(s)("plugins.generic.codecheck.identifier.label")),1),e.createElementVNode("p",null,e.toDisplayString(o.value.certificate),1)])):e.createCommentVNode("",!0),a.value&&o.value.manifest&&o.value.manifest.length>0?(e.openBlock(),e.createElementBlock("div",q,[e.createElementVNode("h4",null,e.toDisplayString(e.unref(s)("plugins.generic.codecheck.review.manifestFiles")),1),e.createElementVNode("ul",null,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(o.value.manifest,(k,m)=>(e.openBlock(),e.createElementBlock("li",{key:m},[e.createElementVNode("strong",null,e.toDisplayString(k.file),1),k.comment?(e.openBlock(),e.createElementBlock("span",j," - "+e.toDisplayString(k.comment),1)):e.createCommentVNode("",!0)]))),128))])])):e.createCommentVNode("",!0),a.value&&o.value.codecheckers&&o.value.codecheckers.length>0?(e.openBlock(),e.createElementBlock("div",z,[e.createElementVNode("h4",null,e.toDisplayString(e.unref(s)("plugins.generic.codecheck.review.codecheckers")),1),e.createElementVNode("ul",null,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(o.value.codecheckers,(k,m)=>(e.openBlock(),e.createElementBlock("li",{key:m},[e.createTextVNode(e.toDisplayString(k.name)+" ",1),k.orcid?(e.openBlock(),e.createElementBlock("span",H,e.toDisplayString(k.orcid),1)):e.createCommentVNode("",!0)]))),128))])])):e.createCommentVNode("",!0),a.value&&o.value.repository?(e.openBlock(),e.createElementBlock("div",W,[e.createElementVNode("h4",null,e.toDisplayString(e.unref(s)("plugins.generic.codecheck.repositories.title")),1),e.createElementVNode("a",{href:o.value.repository,target:"_blank"},e.toDisplayString(o.value.repository),9,Y)])):e.createCommentVNode("",!0),a.value&&o.value.checkTime?(e.openBlock(),e.createElementBlock("div",K,[e.createElementVNode("h4",null,e.toDisplayString(e.unref(s)("plugins.generic.codecheck.completionTime.label")),1),e.createElementVNode("p",null,e.toDisplayString(d(o.value.checkTime)),1)])):e.createCommentVNode("",!0),a.value&&o.value.summary?(e.openBlock(),e.createElementBlock("div",J,[e.createElementVNode("h4",null,e.toDisplayString(e.unref(s)("plugins.generic.codecheck.certificate.summary")),1),e.createElementVNode("p",null,e.toDisplayString(o.value.summary),1)])):e.createCommentVNode("",!0),a.value&&o.value.reportUrl?(e.openBlock(),e.createElementBlock("div",X,[e.createElementVNode("h4",null,e.toDisplayString(e.unref(s)("plugins.generic.codecheck.review.reportUrl")),1),e.createElementVNode("a",{href:o.value.reportUrl,target:"_blank"},e.toDisplayString(o.value.reportUrl),9,G)])):e.createCommentVNode("",!0),e.createElementVNode("div",Q,[e.createVNode(y,{onClick:h},{default:e.withCtx(()=>[e.createTextVNode(e.toDisplayString(e.unref(s)("plugins.generic.codecheck.viewFullMetadata")),1)]),_:1})])])):(e.openBlock(),e.createElementBlock("div",Z,[e.createElementVNode("p",null,e.toDisplayString(e.unref(s)("plugins.generic.codecheck.notOptedIn")),1)]))])}}},[["__scopeId","data-v-2ac9f582"]]),{useLocalize:$}=pkp.modules.useLocalize,ee={name:"CodecheckMetadataForm",props:{submission:{type:Object,required:!0},canEdit:{type:Boolean,default:!0},name:{type:String},value:{type:String}},setup(){const{t:c}=$();return{t:c}},data(){return{loading:!0,saving:!1,dataLoaded:!1,error:null,saveMessage:"",saveMessageType:"",repositories:[],submissionData:{id:null,title:"",authors:[],doi:"",codeRepository:"",dataRepository:"",manifestFiles:"",dataAvailabilityStatement:""},certificateIdentifier:{venueType:"default",venueName:"default",venueTypes:[],venueNames:[],issueUrl:""},metadata:{configVersion:"latest",publicationType:"doi",manifest:[],repository:"",codecheckers:[],certificate:"",checkTime:"",summary:"",reportUrl:""}}},computed:{canPreview(){return this.metadata.manifest.length>0&&this.metadata.codecheckers.length>0&&this.metadata.certificate},isIdentifierReserved(){return this.metadata.certificate.trim()!==""}},mounted(){this.loadData(),this.getVenueData()},methods:{async loadData(){var c,t,s,i,o,a,n,l;this.loading=!0,this.error=null,this.dataLoaded=!1;try{if(!this.submission||!this.submission.id)throw new Error("Invalid submission object");const r=this.submission.id;let d=pkp.context.apiBaseUrl.replace(/\/api\/v1\/?$/,"");d+="/codecheck";const h=`${d}/metadata?submissionId=${r}`,f=await fetch(h,{headers:{"X-Csrf-Token":pkp.currentUser.csrfToken}});if(!f.ok)throw new Error(`HTTP ${f.status}: ${f.statusText}`);const p=await f.json();this.submissionData={id:((c=p.submission)==null?void 0:c.id)||r,title:((t=p.submission)==null?void 0:t.title)||"",authors:Array.isArray((s=p.submission)==null?void 0:s.authors)?p.submission.authors:[],doi:((i=p.submission)==null?void 0:i.doi)||"",codeRepository:((o=p.submission)==null?void 0:o.codeRepository)||"",dataRepository:((a=p.submission)==null?void 0:a.dataRepository)||"",manifestFiles:((n=p.submission)==null?void 0:n.manifestFiles)||"",dataAvailabilityStatement:((l=p.submission)==null?void 0:l.dataAvailabilityStatement)||""},p.codecheck&&typeof p.codecheck=="object"&&(this.metadata={configVersion:p.codecheck.configVersion||p.codecheck.config_version||"latest",publicationType:p.codecheck.publicationType||p.codecheck.publication_type||"doi",manifest:Array.isArray(p.codecheck.manifest)?p.codecheck.manifest:typeof p.codecheck.manifest=="string"?JSON.parse(p.codecheck.manifest):[],repository:p.codecheck.repository||"",codecheckers:Array.isArray(p.codecheck.codecheckers)?p.codecheck.codecheckers:typeof p.codecheck.codecheckers=="string"?JSON.parse(p.codecheck.codecheckers):[],certificate:p.codecheck.certificate||"",checkTime:p.codecheck.checkTime||p.codecheck.check_time?this.formatDateTimeLocal(p.codecheck.checkTime||p.codecheck.check_time):"",summary:p.codecheck.summary||"",reportUrl:p.codecheck.reportUrl||p.codecheck.report_url||""},p.codecheck.repository&&(this.repositories=p.codecheck.repository.split(",").map(y=>y.trim()).filter(y=>y))),this.dataLoaded=!0}catch(r){console.error("Load error:",r),this.error=this.t("plugins.generic.codecheck.loadError")+": "+r.message}finally{this.loading=!1}},triggerFileUpload(){this.$refs.fileInput.click()},handleFileUpload(c){const t=c.target.files;if(!(!t||t.length===0)){for(let s=0;s<t.length;s++)this.metadata.manifest.push({file:t[s].name,size:t[s].size,comment:"",checked:!1});c.target.value=""}},formatFileSize(c){if(c===0)return"0 Bytes";const t=1024,s=["Bytes","KB","MB","GB"],i=Math.floor(Math.log(c)/Math.log(t));return parseFloat((c/Math.pow(t,i)).toFixed(2))+" "+s[i]},removeManifestFile(c){confirm(this.t("plugins.generic.codecheck.manifest.removeConfirm"))&&this.metadata.manifest.splice(c,1)},addRepository(){this.repositories.push("")},removeRepository(c){confirm(this.t("plugins.generic.codecheck.repositories.removeConfirm"))&&this.repositories.splice(c,1)},showCodecheckerModal(){this.canUsePkpModal()?this.showPkpCodecheckerModal():this.showFallbackCodecheckerModal()},canUsePkpModal(){return typeof pkp<"u"&&pkp.modules&&pkp.modules.useModal},showPkpCodecheckerModal(){const{useModal:c}=pkp.modules.useModal,{openDialog:t}=c(),s='<div class="modal-form"><div class="modal-field"><label for="checker-name" class="modal-label">'+this.t("plugins.generic.codecheck.codecheckers.enterName")+'</label><input type="text" id="checker-name" class="modal-input" placeholder="'+this.t("plugins.generic.codecheck.codecheckers.enterName")+'" /></div><div class="modal-field"><label for="checker-orcid" class="modal-label">'+this.t("plugins.generic.codecheck.codecheckers.enterOrcid")+'</label><input type="text" id="checker-orcid" class="modal-input" placeholder="0000-0000-0000-0000" /></div></div>';t({title:this.t("plugins.generic.codecheck.codecheckers.add"),message:s,actions:[{label:this.t("plugins.generic.codecheck.modal.cancel"),callback:i=>i()},{label:this.t("plugins.generic.codecheck.modal.add"),isPrimary:!0,callback:i=>{const o=document.getElementById("checker-name"),a=document.getElementById("checker-orcid"),n=(o==null?void 0:o.value)||"",l=(a==null?void 0:a.value)||"";n.trim()&&this.metadata.codecheckers.push({name:n.trim(),orcid:l.trim()}),i()}}]})},showFallbackCodecheckerModal(){const c=prompt(this.t("plugins.generic.codecheck.codecheckers.enterName"));if(c&&c.trim()){const t=prompt(this.t("plugins.generic.codecheck.codecheckers.enterOrcid"));this.metadata.codecheckers.push({name:c.trim(),orcid:t?t.trim():""})}},removeCodechecker(c){confirm(this.t("plugins.generic.codecheck.codecheckers.removeConfirm"))&&this.metadata.codecheckers.splice(c,1)},async saveMetadata(){if(this.validateForm()){this.saving=!0,this.saveMessage="";try{const c={config_version:this.metadata.configVersion,publication_type:this.metadata.publicationType,manifest:this.metadata.manifest,repository:this.repositories.join(", "),codecheckers:this.metadata.codecheckers,certificate:this.metadata.certificate,check_time:this.metadata.checkTime,summary:this.metadata.summary,report_url:this.metadata.reportUrl};console.log("Saving CODECHECK data:",c);const t=this.submission.id;let s=pkp.context.apiBaseUrl.replace(/\/api\/v1\/?$/,"");s+="/codecheck";const i=`${s}/metadata?submissionId=${t}`;if(!(await fetch(i,{method:"POST",headers:{"Content-Type":"application/json","X-Csrf-Token":pkp.currentUser.csrfToken},body:JSON.stringify(c)})).ok)throw new Error("Failed to save");this.showMessage(this.t("plugins.generic.codecheck.savedSuccessfully"),"success")}catch(c){console.error("Save error:",c),this.showMessage(this.t("plugins.generic.codecheck.saveFailed"),"error")}finally{this.saving=!1}}},async previewYaml(){try{const c=this.generateYamlContent();this.canUsePkpModal()?this.showYamlModal(c):this.showYamlFallback(c)}catch{this.showMessage(this.t("plugins.generic.codecheck.yamlPreviewFailed"),"error")}},generateYamlContent(){const c=[];return c.push("---"),c.push("version: https://codecheck.org.uk/spec/config/"+this.metadata.configVersion+"/"),c.push("paper:"),c.push('  title: "'+(this.submissionData.title||"Untitled")+'"'),c.push("  authors:"),this.submissionData.authors&&this.submissionData.authors.length>0&&this.submissionData.authors.forEach(t=>{c.push("    - name: "+t.name),t.orcid&&c.push("      ORCID: "+t.orcid)}),this.submissionData.doi&&c.push("  reference: https://doi.org/"+this.submissionData.doi),c.push("manifest:"),this.metadata.manifest&&this.metadata.manifest.length>0&&this.metadata.manifest.forEach(t=>{c.push("  - file: "+t.file),t.comment&&c.push('    comment: "'+t.comment+'"')}),c.push("codechecker:"),this.metadata.codecheckers&&this.metadata.codecheckers.length>0&&this.metadata.codecheckers.forEach(t=>{c.push("  - name: "+t.name),t.orcid&&c.push("    ORCID: "+t.orcid)}),this.metadata.summary&&(c.push("summary: >"),this.metadata.summary.split(`
`).forEach(s=>{c.push("  "+s)})),this.repositories.length>0&&c.push("repository: "+this.repositories[0]),this.metadata.checkTime&&c.push('check_time: "'+this.metadata.checkTime+'"'),this.metadata.certificate&&c.push("certificate: "+this.metadata.certificate),this.metadata.reportUrl&&c.push("report: "+this.metadata.reportUrl),c.join(`
`)},showYamlModal(c){const{useModal:t}=pkp.modules.useModal,{openDialog:s}=t(),i="downloadCodecheckYaml_"+Date.now();window[i]=function(){const a=new Blob([c],{type:"text/yaml"}),n=URL.createObjectURL(a),l=document.createElement("a");l.href=n,l.download="codecheck.yml",l.click(),URL.revokeObjectURL(n)};const o='<div class="yaml-modal-container"><pre class="yaml-preview-content">'+this.escapeHtml(c)+"</pre></div>";s({title:this.t("plugins.generic.codecheck.yaml.previewTitle"),message:o,actions:[{label:this.t("plugins.generic.codecheck.yaml.download"),isPrimary:!0,callback:a=>{window[i](),delete window[i],a()}},{label:this.t("plugins.generic.codecheck.yaml.close"),callback:a=>{delete window[i],a()}}]})},showYamlFallback(c){const t=window.open("","_blank"),s=this.escapeHtml(c),i=JSON.stringify(c),o='<!DOCTYPE html><html><head><title>CODECHECK Metadata Preview</title><style>body { font-family: "Courier New", monospace; padding: 20px; background: #f5f5f5; }.container { max-width: 900px; margin: 0 auto; background: white; padding: 30px; border-radius: 8px; box-shadow: 0 2px 10px rgba(0,0,0,0.1); }h2 { color: #007ab2; margin-top: 0; }pre { background: #2d2d2d; color: #f8f8f2; padding: 20px; border-radius: 4px; overflow-x: auto; line-height: 1.6; }.actions { margin-top: 20px; display: flex; gap: 10px; }button { padding: 10px 20px; border: none; border-radius: 4px; cursor: pointer; font-weight: 600; font-size: 14px; }.download-btn { background: #007ab2; color: white; }.download-btn:hover { background: #005a87; }.close-btn { background: #dc3545; color: white; }.close-btn:hover { background: #c82333; }</style></head><body><div class="container"><h2>ðŸ“„ CODECHECK Metadata Preview</h2><pre>'+s+"</pre></div><script>function downloadYaml() {  const blob = new Blob(["+i+'], { type: "text/yaml" });  const url = URL.createObjectURL(blob);  const a = document.createElement("a");  a.href = url;  a.download = "codecheck.yml";  a.click();  URL.revokeObjectURL(url);}<\\/script></body></html>';t.document.write(o)},async getVenueData(){let c=pkp.context.apiBaseUrl.replace(/\/api\/v1\/?$/,"");c+="/codecheck_api";try{const s=await(await fetch(`${c}/getVenueData`,{method:"POST",headers:{"Content-Type":"application/json","X-Csrf-Token":pkp.currentUser.csrfToken}})).json();s.success?(console.log("Success:",s.message),this.certificateIdentifier.venueTypes=s.venueTypes,this.certificateIdentifier.venueNames=s.venueNames,console.log("Venue types:",this.certificateIdentifier.venueTypes),console.log("Venue names:",this.certificateIdentifier.venueNames)):console.error("Error:",s.error)}catch(t){console.error("Failed to fetch venue data:",t)}},async reserveIdentifier(){if(this.certificateIdentifier.venueType==="default"||this.certificateIdentifier.venueName==="default"){alert("Please select both a Venue Type and a Venue Name.");return}const c=this.submissionData.authors.length>1?this.submissionData.authors[0].name+" et al.":this.submissionData.authors[0].name;console.log(c);let t=pkp.context.apiBaseUrl.replace(/\/api\/v1\/?$/,"");t+="/codecheck_api";try{const i=await(await fetch(`${t}/reserveIdentifier`,{method:"POST",headers:{"Content-Type":"application/json","X-Csrf-Token":pkp.currentUser.csrfToken},body:JSON.stringify({venueType:this.certificateIdentifier.venueType,venueName:this.certificateIdentifier.venueName,authorString:c})})).json();i.success?(this.metadata.certificate=i.identifier,this.certificateIdentifier.issueUrl=i.issueUrl,this.$emit("update",this.metadata.certificate),alert(`New identifier reserved: ${i.identifier}`),console.log("New identifier reserved: ",i.identifier,i.issueUrl)):console.error("Error:",i.error)}catch(s){console.error("Request failed:",s)}},removeIdentifier(c){this.metadata.certificate="",this.certificateIdentifier.issueUrl="",this.$emit("update",this.metadata.certificate),c()},showRemoveIdentifierModal(){if(!this.canUsePkpModal()){this.fallbackCertificateIdentifierModal();return}const{useModal:c}=pkp.modules.useModal,{openDialog:t}=c();t({title:"Remove Certificate Identifier",message:`
          <div class="modal-form">
            <div class="modal-field">
              <label for="repo-url" class="modal-label">Are you sure you want to remove this identifier?</label>
            </div>
          </div>
        `,actions:[{label:"No",callback:s=>s()},{label:"Yes",isPrimary:!0,callback:s=>{this.removeIdentifier(s)}}]})},fallbackCertificateIdentifierModal(){confirm("Are you sure you want to remove this identifier?")&&(this.metadata.certificate="",this.certificateIdentifier.issueUrl="",this.$emit("update",this.metadata.certificate))},escapeHtml(c){const t=document.createElement("div");return t.textContent=c,t.innerHTML},validateForm(){return this.metadata.manifest.length===0?(this.showMessage(this.t("plugins.generic.codecheck.validation.manifestRequired"),"error"),!1):this.metadata.codecheckers.length===0?(this.showMessage(this.t("plugins.generic.codecheck.validation.codecheckersRequired"),"error"),!1):this.metadata.certificate?this.metadata.summary?!0:(this.showMessage(this.t("plugins.generic.codecheck.validation.summaryRequired"),"error"),!1):(this.showMessage(this.t("plugins.generic.codecheck.validation.certificateRequired"),"error"),!1)},showMessage(c,t){this.saveMessage=c,this.saveMessageType=t,setTimeout(()=>{this.saveMessage=""},5e3)},formatDateTimeLocal(c){const t=new Date(c),s=t.getFullYear(),i=String(t.getMonth()+1).padStart(2,"0"),o=String(t.getDate()).padStart(2,"0"),a=String(t.getHours()).padStart(2,"0"),n=String(t.getMinutes()).padStart(2,"0");return s+"-"+i+"-"+o+"T"+a+":"+n}}},te={class:"codecheck-metadata-form"},oe={key:0,class:"loading-state"},ie={key:1,class:"error-state"},ne={key:2},ce={class:"codecheck-header"},se={class:"header-content"},ae={class:"workflow-title"},re={class:"version-selector"},le={class:"version-label"},de={class:"publication-section"},pe={class:"radio-options"},me={class:"radio-option"},he={class:"radio-label"},ke={class:"radio-option"},fe={class:"radio-label"},ue={class:"form-section read-only-section"},ge={class:"section-title"},ye={class:"info-grid"},be={class:"info-item"},_e={class:"info-label"},Ee={class:"info-value"},Ve={class:"info-item"},Ne={class:"info-label"},we={class:"info-value"},De={key:0,class:"orcid-badge"},Ce={key:1},Be={key:0,class:"info-item"},Se={class:"info-label"},Me={class:"info-value"},Te=["href"],Ie={key:1,class:"info-item"},Fe={class:"info-label"},Ue={class:"info-value"},xe=["href"],Re={key:2,class:"info-item"},Le={class:"info-label"},Oe={class:"info-value"},Ae=["href"],Pe={key:3,class:"info-item"},qe={class:"info-label"},je={class:"info-value"},ze={class:"manifest-preview"},He={class:"form-section"},We={class:"section-title"},Ye={class:"section-description"},Ke={class:"field-group"},Je={class:"field-header"},Xe={class:"field-label"},Ge={class:"field-description"},Qe={key:0,class:"pkpTable manifest-table"},Ze=["onUpdate:modelValue"],ve={class:"file-info"},$e={class:"file-name"},et={key:0,class:"file-size"},tt=["onUpdate:modelValue","placeholder"],ot=["onClick"],it={key:1,class:"empty-state"},nt={class:"field-group"},ct={class:"field-header"},st={class:"field-label"},at={class:"field-description"},rt={key:0,class:"repository-list"},lt=["onUpdate:modelValue","placeholder"],dt=["onClick"],pt={key:1,class:"empty-state"},mt={class:"field-group"},ht={class:"field-header"},kt={class:"field-label"},ft={key:0,class:"items-list"},ut={class:"item-content"},gt={class:"item-name"},yt={key:0,class:"item-orcid"},bt=["onClick"],_t={key:1,class:"empty-state"},Et={class:"field-group"},Vt={class:"field-label"},Nt={class:"field-group"},wt={class:"field-label"},Dt={class:"field-description"},Ct=["placeholder"],Bt={class:"field-group"},St={class:"field-label"},Mt={class:"field-description"},Tt={class:"form-section identifier-section"},It={class:"section-title"},Ft={class:"certificate-identifier-section"},Ut={class:"certificate-identifier-input-wrapper"},xt=["placeholder"],Rt=["disabled"],Lt=["value"],Ot=["disabled"],At=["value"],Pt={key:0,class:"certificate-identifier-link-wrapper"},qt=["href"],jt={class:"identifier-actions",id:"certificate-identifier-button-wrapper"},zt=["disabled"],Ht={class:"form-footer"},Wt={class:"footer-actions"},Yt=["disabled"],Kt=["disabled"];function Jt(c,t,s,i,o,a){return e.openBlock(),e.createElementBlock("div",te,[o.loading?(e.openBlock(),e.createElementBlock("div",oe,[t[18]||(t[18]=e.createElementVNode("span",{class:"pkpSpinner"},null,-1)),e.createElementVNode("p",null,e.toDisplayString(i.t("common.loading")),1)])):o.error?(e.openBlock(),e.createElementBlock("div",ie,[e.createElementVNode("p",null,e.toDisplayString(o.error),1),e.createElementVNode("button",{class:"pkpButton",onClick:t[0]||(t[0]=(...n)=>a.loadData&&a.loadData(...n))},e.toDisplayString(i.t("common.retry")),1)])):o.dataLoaded?(e.openBlock(),e.createElementBlock("div",ne,[e.createElementVNode("div",ce,[e.createElementVNode("div",se,[e.createElementVNode("h2",ae,e.toDisplayString(i.t("plugins.generic.codecheck.workflow.title")),1),e.createElementVNode("div",re,[e.createElementVNode("label",le,e.toDisplayString(i.t("plugins.generic.codecheck.configVersion")),1),e.withDirectives(e.createElementVNode("select",{"onUpdate:modelValue":t[1]||(t[1]=n=>o.metadata.configVersion=n),class:"version-select"},[...t[19]||(t[19]=[e.createElementVNode("option",{value:"latest"},"latest",-1),e.createElementVNode("option",{value:"1.0"},"1.0",-1)])],512),[[e.vModelSelect,o.metadata.configVersion]])])])]),e.createElementVNode("div",de,[e.createElementVNode("div",pe,[e.createElementVNode("label",me,[e.withDirectives(e.createElementVNode("input",{type:"radio","onUpdate:modelValue":t[2]||(t[2]=n=>o.metadata.publicationType=n),value:"doi",name:"publication-type"},null,512),[[e.vModelRadio,o.metadata.publicationType]]),e.createElementVNode("span",he,e.toDisplayString(i.t("plugins.generic.codecheck.publishWithDOI")),1)]),e.createElementVNode("label",ke,[e.withDirectives(e.createElementVNode("input",{type:"radio","onUpdate:modelValue":t[3]||(t[3]=n=>o.metadata.publicationType=n),value:"separate",name:"publication-type"},null,512),[[e.vModelRadio,o.metadata.publicationType]]),e.createElementVNode("span",fe,e.toDisplayString(i.t("plugins.generic.codecheck.publishSeparate")),1)])])]),e.createElementVNode("div",ue,[e.createElementVNode("h3",ge,e.toDisplayString(i.t("plugins.generic.codecheck.paperMetadata.title")),1),e.createElementVNode("div",ye,[e.createElementVNode("div",be,[e.createElementVNode("label",_e,e.toDisplayString(i.t("common.title"))+":",1),e.createElementVNode("div",Ee,e.toDisplayString(o.submissionData.title||i.t("common.notAvailable")),1)]),e.createElementVNode("div",Ve,[e.createElementVNode("label",Ne,e.toDisplayString(i.t("plugins.generic.codecheck.paperMetadata.authors"))+":",1),e.createElementVNode("div",we,[o.submissionData.authors&&o.submissionData.authors.length>0?(e.openBlock(!0),e.createElementBlock(e.Fragment,{key:0},e.renderList(o.submissionData.authors,(n,l)=>(e.openBlock(),e.createElementBlock("div",{key:"author-"+l,class:"author-item"},[e.createTextVNode(e.toDisplayString(n.name||i.t("common.unknown"))+" ",1),n.orcid?(e.openBlock(),e.createElementBlock("span",De,e.toDisplayString(n.orcid),1)):e.createCommentVNode("",!0)]))),128)):(e.openBlock(),e.createElementBlock("em",Ce,e.toDisplayString(i.t("plugins.generic.codecheck.paperMetadata.noAuthors")),1))])]),o.submissionData.doi?(e.openBlock(),e.createElementBlock("div",Be,[e.createElementVNode("label",Se,e.toDisplayString(i.t("metadata.property.displayName.doi"))+":",1),e.createElementVNode("div",Me,[e.createElementVNode("a",{href:"https://doi.org/"+o.submissionData.doi,target:"_blank"},e.toDisplayString(o.submissionData.doi),9,Te)])])):e.createCommentVNode("",!0),o.submissionData.codeRepository?(e.openBlock(),e.createElementBlock("div",Ie,[e.createElementVNode("label",Fe,e.toDisplayString(i.t("plugins.generic.codecheck.codeRepository"))+":",1),e.createElementVNode("div",Ue,[e.createElementVNode("a",{href:o.submissionData.codeRepository,target:"_blank"},e.toDisplayString(o.submissionData.codeRepository),9,xe)])])):e.createCommentVNode("",!0),o.submissionData.dataRepository?(e.openBlock(),e.createElementBlock("div",Re,[e.createElementVNode("label",Le,e.toDisplayString(i.t("plugins.generic.codecheck.dataRepository"))+":",1),e.createElementVNode("div",Oe,[e.createElementVNode("a",{href:o.submissionData.dataRepository,target:"_blank"},e.toDisplayString(o.submissionData.dataRepository),9,Ae)])])):e.createCommentVNode("",!0),o.submissionData.manifestFiles?(e.openBlock(),e.createElementBlock("div",Pe,[e.createElementVNode("label",qe,e.toDisplayString(i.t("plugins.generic.codecheck.manifestFiles.label"))+":",1),e.createElementVNode("div",je,[e.createElementVNode("pre",ze,e.toDisplayString(o.submissionData.manifestFiles),1)])])):e.createCommentVNode("",!0)])]),e.createElementVNode("div",He,[e.createElementVNode("h3",We,e.toDisplayString(i.t("plugins.generic.codecheck.details.title")),1),e.createElementVNode("p",Ye,e.toDisplayString(i.t("plugins.generic.codecheck.workflow.description")),1),e.createElementVNode("div",Ke,[e.createElementVNode("div",Je,[e.createElementVNode("label",Xe,[e.createTextVNode(e.toDisplayString(i.t("plugins.generic.codecheck.manifest.title"))+" ",1),t[20]||(t[20]=e.createElementVNode("span",{class:"required"},"*",-1))]),e.createElementVNode("button",{type:"button",class:"pkpButton btn-add",onClick:t[4]||(t[4]=(...n)=>a.triggerFileUpload&&a.triggerFileUpload(...n))},e.toDisplayString(i.t("plugins.generic.codecheck.manifestFiles.addFile")),1),e.createElementVNode("input",{type:"file",ref:"fileInput",onChange:t[5]||(t[5]=(...n)=>a.handleFileUpload&&a.handleFileUpload(...n)),multiple:"",style:{position:"absolute",left:"-9999px",opacity:"0"},accept:".pdf,.csv,.txt,.yml,.yaml,.json,.zip,.png,.jpg"},null,544)]),e.createElementVNode("p",Ge,e.toDisplayString(i.t("plugins.generic.codecheck.manifest.description")),1),o.metadata.manifest&&o.metadata.manifest.length>0?(e.openBlock(),e.createElementBlock("table",Qe,[e.createElementVNode("thead",null,[e.createElementVNode("tr",null,[t[21]||(t[21]=e.createElementVNode("th",{width:"20"},null,-1)),e.createElementVNode("th",null,e.toDisplayString(i.t("plugins.generic.codecheck.manifest.addFile")),1),e.createElementVNode("th",null,e.toDisplayString(i.t("common.comment")),1),t[22]||(t[22]=e.createElementVNode("th",{width:"80"},null,-1))])]),e.createElementVNode("tbody",null,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(o.metadata.manifest,(n,l)=>(e.openBlock(),e.createElementBlock("tr",{key:"manifest-"+l,class:"manifest-row"},[e.createElementVNode("td",null,[e.withDirectives(e.createElementVNode("input",{type:"checkbox","onUpdate:modelValue":r=>n.checked=r,class:"file-checkbox"},null,8,Ze),[[e.vModelCheckbox,n.checked]])]),e.createElementVNode("td",null,[e.createElementVNode("div",ve,[e.createElementVNode("span",$e,e.toDisplayString(n.file),1),n.size?(e.openBlock(),e.createElementBlock("span",et,"("+e.toDisplayString(a.formatFileSize(n.size))+")",1)):e.createCommentVNode("",!0)])]),e.createElementVNode("td",null,[e.withDirectives(e.createElementVNode("input",{type:"text","onUpdate:modelValue":r=>n.comment=r,class:"pkpFormField__input",placeholder:i.t("plugins.generic.codecheck.manifestFiles.commentPlaceholder")},null,8,tt),[[e.vModelText,n.comment]])]),e.createElementVNode("td",null,[e.createElementVNode("button",{type:"button",class:"pkpButton codecheck-btn pkpButton--isWarnable",onClick:r=>a.removeManifestFile(l)},"Ã—",8,ot)])]))),128))])])):(e.openBlock(),e.createElementBlock("div",it,e.toDisplayString(i.t("plugins.generic.codecheck.manifest.emptyState")),1))]),e.createElementVNode("div",nt,[e.createElementVNode("div",ct,[e.createElementVNode("label",st,e.toDisplayString(i.t("plugins.generic.codecheck.repositories.title")),1),e.createElementVNode("button",{type:"button",class:"pkpButton btn-add",onClick:t[6]||(t[6]=(...n)=>a.addRepository&&a.addRepository(...n))},e.toDisplayString(i.t("plugins.generic.codecheck.repositories.add")),1)]),e.createElementVNode("p",at,e.toDisplayString(i.t("plugins.generic.codecheck.repositories.description")),1),o.repositories.length>0?(e.openBlock(),e.createElementBlock("div",rt,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(o.repositories,(n,l)=>(e.openBlock(),e.createElementBlock("div",{key:"repo-"+l,class:"repository-item"},[e.withDirectives(e.createElementVNode("input",{type:"url","onUpdate:modelValue":r=>o.repositories[l]=r,class:"pkpFormField__input",placeholder:i.t("plugins.generic.codecheck.repository.placeholder")},null,8,lt),[[e.vModelText,o.repositories[l]]]),e.createElementVNode("button",{type:"button",class:"pkpButton codecheck-btn pkpButton--isWarnable",onClick:r=>a.removeRepository(l)},"Ã—",8,dt)]))),128))])):(e.openBlock(),e.createElementBlock("div",pt," No repositories added yet "))]),e.createElementVNode("div",mt,[e.createElementVNode("div",ht,[e.createElementVNode("label",kt,[e.createTextVNode(e.toDisplayString(i.t("plugins.generic.codecheck.codecheckers.title"))+" ",1),t[23]||(t[23]=e.createElementVNode("span",{class:"required"},"*",-1))]),e.createElementVNode("button",{type:"button",class:"pkpButton btn-add",onClick:t[7]||(t[7]=(...n)=>a.showCodecheckerModal&&a.showCodecheckerModal(...n))},e.toDisplayString(i.t("plugins.generic.codecheck.codecheckers.add")),1)]),o.metadata.codecheckers&&o.metadata.codecheckers.length>0?(e.openBlock(),e.createElementBlock("div",ft,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(o.metadata.codecheckers,(n,l)=>(e.openBlock(),e.createElementBlock("div",{key:"checker-"+l,class:"list-item"},[e.createElementVNode("div",ut,[e.createElementVNode("div",gt,e.toDisplayString(n.name),1),n.orcid?(e.openBlock(),e.createElementBlock("div",yt,"ORCID: "+e.toDisplayString(n.orcid),1)):e.createCommentVNode("",!0)]),e.createElementVNode("button",{type:"button",class:"pkpButton codecheck-btn pkpButton--isWarnable",onClick:r=>a.removeCodechecker(l)},"Ã—",8,bt)]))),128))])):(e.openBlock(),e.createElementBlock("div",_t,e.toDisplayString(i.t("plugins.generic.codecheck.codecheckers.emptyState")),1))]),e.createElementVNode("div",Et,[e.createElementVNode("label",Vt,e.toDisplayString(i.t("plugins.generic.codecheck.completionTime.label")),1),e.withDirectives(e.createElementVNode("input",{type:"datetime-local","onUpdate:modelValue":t[8]||(t[8]=n=>o.metadata.checkTime=n),class:"pkpFormField__input full-width"},null,512),[[e.vModelText,o.metadata.checkTime]])]),e.createElementVNode("div",Nt,[e.createElementVNode("label",wt,[e.createTextVNode(e.toDisplayString(i.t("plugins.generic.codecheck.certificate.summary"))+" ",1),t[24]||(t[24]=e.createElementVNode("span",{class:"required"},"*",-1))]),e.createElementVNode("p",Dt,e.toDisplayString(i.t("plugins.generic.codecheck.certificate.summaryDescription")),1),e.withDirectives(e.createElementVNode("textarea",{"onUpdate:modelValue":t[9]||(t[9]=n=>o.metadata.summary=n),class:"pkpFormField__input pkpFormField__input--textarea full-width",rows:"6",placeholder:i.t("plugins.generic.codecheck.certificate.summaryPlaceholder")},null,8,Ct),[[e.vModelText,o.metadata.summary]])]),e.createElementVNode("div",Bt,[e.createElementVNode("label",St,e.toDisplayString(i.t("plugins.generic.codecheck.certificate.reportUrl")),1),e.createElementVNode("p",Mt,e.toDisplayString(i.t("plugins.generic.codecheck.certificate.reportUrlDescription")),1),e.withDirectives(e.createElementVNode("input",{type:"url","onUpdate:modelValue":t[10]||(t[10]=n=>o.metadata.reportUrl=n),class:"pkpFormField__input full-width",placeholder:"https://zenodo.org/record/12345"},null,512),[[e.vModelText,o.metadata.reportUrl]])])]),e.createElementVNode("div",Tt,[e.createElementVNode("h3",It,[e.createTextVNode(e.toDisplayString(i.t("plugins.generic.codecheck.identifier.title"))+" ",1),t[25]||(t[25]=e.createElementVNode("span",{class:"required"},"*",-1))]),e.createElementVNode("div",Ft,[e.createElementVNode("div",Ut,[e.withDirectives(e.createElementVNode("input",{type:"text","onUpdate:modelValue":t[11]||(t[11]=n=>o.metadata.certificate=n),placeholder:i.t("plugins.generic.codecheck.identifier.label"),class:"certificate-identifier-input",readonly:""},null,8,xt),[[e.vModelText,o.metadata.certificate]]),e.withDirectives(e.createElementVNode("select",{"onUpdate:modelValue":t[12]||(t[12]=n=>o.certificateIdentifier.venueType=n),class:"certificate-identifier-select certificate-identifier-venue-types",disabled:a.isIdentifierReserved},[t[26]||(t[26]=e.createElementVNode("option",{disabled:"",value:"default",selected:""},"Venue Type",-1)),(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(o.certificateIdentifier.venueTypes,n=>(e.openBlock(),e.createElementBlock("option",{key:n,value:n},e.toDisplayString(n),9,Lt))),128))],8,Rt),[[e.vModelSelect,o.certificateIdentifier.venueType]]),e.withDirectives(e.createElementVNode("select",{"onUpdate:modelValue":t[13]||(t[13]=n=>o.certificateIdentifier.venueName=n),class:"certificate-identifier-select certificate-identifier-venue-names",disabled:a.isIdentifierReserved},[t[27]||(t[27]=e.createElementVNode("option",{disabled:"",value:"default",selected:""},"Venue Name",-1)),(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(o.certificateIdentifier.venueNames,n=>(e.openBlock(),e.createElementBlock("option",{key:n,value:n},e.toDisplayString(n),9,At))),128))],8,Ot),[[e.vModelSelect,o.certificateIdentifier.venueName]])]),o.certificateIdentifier.issueUrl?(e.openBlock(),e.createElementBlock("div",Pt,[e.createElementVNode("a",{href:o.certificateIdentifier.issueUrl,target:"_blank"}," View GitHub Issue ",8,qt)])):e.createCommentVNode("",!0),e.createElementVNode("div",jt,[e.createElementVNode("button",{type:"button",class:e.normalizeClass(["pkpButton codecheck-btn certificate-identifier-button",a.isIdentifierReserved?"bg-gray":""]),disabled:a.isIdentifierReserved,onClick:t[14]||(t[14]=(...n)=>a.reserveIdentifier&&a.reserveIdentifier(...n))},e.toDisplayString(i.t("plugins.generic.codecheck.identifier.reserve")),11,zt),e.createElementVNode("button",{type:"button",class:"pkpButton codecheck-btn pkpButton--isWarnable codecheck-btn-warning certificate-identifier-button",onClick:t[15]||(t[15]=(...n)=>a.showRemoveIdentifierModal&&a.showRemoveIdentifierModal(...n))},e.toDisplayString(i.t("plugins.generic.codecheck.identifier.remove")),1)])])]),e.createElementVNode("div",Ht,[e.createElementVNode("div",Wt,[e.createElementVNode("button",{type:"button",class:"pkpButton codecheck-btn",onClick:t[16]||(t[16]=(...n)=>a.previewYaml&&a.previewYaml(...n)),disabled:!a.canPreview},e.toDisplayString(i.t("plugins.generic.codecheck.previewYaml")),9,Yt),e.createElementVNode("button",{type:"button",class:"pkpButton codecheck-btn pkpButton--isPrimary",onClick:t[17]||(t[17]=(...n)=>a.saveMetadata&&a.saveMetadata(...n)),disabled:o.saving},e.toDisplayString(o.saving?i.t("common.saving"):i.t("common.save")),9,Kt)]),o.saveMessage?(e.openBlock(),e.createElementBlock("div",{key:0,class:e.normalizeClass(["save-message",o.saveMessageType])},e.toDisplayString(o.saveMessage),3)):e.createCommentVNode("",!0)])])):e.createCommentVNode("",!0)])}const V=b(ee,[["render",Jt]]),Xt={name:"CodecheckMetadataFormWrapper",props:{submission:{type:Object,required:!0},canEdit:{type:Boolean,default:!0}},mounted(){const c=this.$el;e.createApp(V,{submission:this.submission,canEdit:this.canEdit}).mount(c)}},Gt={id:"codecheck-metadata-container"};function Qt(c,t,s,i,o,a){return e.openBlock(),e.createElementBlock("div",Gt)}const Zt=b(Xt,[["render",Qt]]),vt={class:"certificate-identifier-section"},$t={class:"certificate-identifier-input-wrapper"},eo=["disabled"],to=["value"],oo=["disabled"],io=["value"],no={key:0,class:"certificate-identifier-link-wrapper"},co=["href"],so={class:"certificate-identifier-button-wrapper"},ao=["disabled"],N=b({__name:"CodecheckCertificateIdentifier",props:{name:String,value:String},emits:["update"],setup(c,{emit:t}){const s=c,i=t,o=e.ref(s.value||""),a=e.ref("default"),n=e.ref("default"),l=e.ref([]),r=e.ref([]),d=e.ref(""),h=e.computed(()=>o.value.trim()!=="");e.onMounted(()=>{f()}),e.watch(o,u=>{i("update",u)});async function f(){let u=pkp.context.apiBaseUrl.replace(/\/api\/v1\/?$/,"");u+="/codecheck_api";try{const m=await(await fetch(`${u}/getVenueData`,{method:"POST",headers:{"Content-Type":"application/json","X-Csrf-Token":pkp.currentUser.csrfToken}})).json();m.success?(console.log("Success:",m.message),l.value=m.venueTypes,r.value=m.venueNames):console.error("Error:",m.error)}catch(k){console.error("Failed to fetch venue data:",k)}}async function p(){if(a.value==="default"||n.value==="default"){alert("Please select both a Venue Type and a Venue Name.");return}let u=pkp.context.apiBaseUrl.replace(/\/api\/v1\/?$/,"");u+="/codecheck_api";try{const m=await(await fetch(`${u}/reserveIdentifier`,{method:"POST",headers:{"Content-Type":"application/json","X-Csrf-Token":pkp.currentUser.csrfToken},body:JSON.stringify({venueType:a.value,venueName:n.value})})).json();m.success?(o.value=m.identifier,d.value=m.issueUrl,alert(`Added new issue with identifier: ${m.identifier}`),console.log("Added new issue with identifier: ",m.identifier,m.issueUrl)):console.error("Error:",m.error)}catch(k){console.error("Request failed:",k)}}function y(){o.value="",d.value=""}return(u,k)=>(e.openBlock(),e.createElementBlock("div",vt,[e.createElementVNode("div",$t,[e.withDirectives(e.createElementVNode("input",{type:"text","onUpdate:modelValue":k[0]||(k[0]=m=>o.value=m),placeholder:"ID - e.g.: 2025-001",class:"certificate-identifier-input",readonly:""},null,512),[[e.vModelText,o.value]]),e.withDirectives(e.createElementVNode("select",{"onUpdate:modelValue":k[1]||(k[1]=m=>a.value=m),class:"certificate-identifier-select certificate-identifier-venue-types",disabled:h.value},[k[3]||(k[3]=e.createElementVNode("option",{disabled:"",value:"default"},"Venue Type",-1)),(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(l.value,m=>(e.openBlock(),e.createElementBlock("option",{key:m,value:m},e.toDisplayString(m),9,to))),128))],8,eo),[[e.vModelSelect,a.value]]),e.withDirectives(e.createElementVNode("select",{"onUpdate:modelValue":k[2]||(k[2]=m=>n.value=m),class:"certificate-identifier-select certificate-identifier-venue-names",disabled:h.value},[k[4]||(k[4]=e.createElementVNode("option",{disabled:"",value:"default"},"Venue Name",-1)),(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(r.value,m=>(e.openBlock(),e.createElementBlock("option",{key:m,value:m},e.toDisplayString(m),9,io))),128))],8,oo),[[e.vModelSelect,n.value]])]),d.value?(e.openBlock(),e.createElementBlock("div",no,[e.createElementVNode("a",{href:d.value,target:"_blank"}," View GitHub Issue ",8,co)])):e.createCommentVNode("",!0),e.createElementVNode("div",so,[e.createElementVNode("button",{type:"button",class:e.normalizeClass(["certificate-identifier-button",h.value?"bg-gray":"bg-blue"]),disabled:h.value,onClick:p}," Reserve Identifier ",10,ao),e.createElementVNode("button",{type:"button",class:"certificate-identifier-button bg-red",onClick:y}," Remove Identifier ")])]))}},[["__scopeId","data-v-07386d77"]]);pkp.registry.registerComponent("CodecheckReviewDisplay",v),pkp.registry.registerComponent("CodecheckMetadataForm",V),pkp.registry.registerComponent("CodecheckMetadataFormWrapper",Zt),pkp.registry.registerComponent("CodecheckManifestFiles",E),pkp.registry.registerComponent("CodecheckRepositoryList",_),pkp.registry.registerComponent("CodecheckCertificateIdentifier",N);const{useLocalize:w}=pkp.modules.useLocalize,{t:g}=w();pkp.registry.storeExtend("workflow",c=>{const t=c.store;t.extender.extendFn("getMenuItems",(s,i)=>{const o=i==null?void 0:i.submission;if((o==null?void 0:o.codecheckOptIn)==!0||(o==null?void 0:o.codecheckOptIn)==1||(o==null?void 0:o.codecheckOptIn)==="1"){const n=[...s],l=n.find(r=>r.key==="workflow");if(l&&l.items){const r={key:"codecheck",label:g("plugins.generic.codecheck.workflow.label"),state:{primaryMenuItem:"workflow",stageId:999}},d=l.items.findIndex(h=>{var f;return((f=h.state)==null?void 0:f.stageId)===pkp.const.WORKFLOW_STAGE_ID_EXTERNAL_REVIEW});d>=0?l.items.splice(d+1,0,r):l.items.push(r)}return n}return s}),t.extender.extendFn("getPrimaryItems",(s,i)=>{var a,n,l,r;const o=i==null?void 0:i.submission;return((a=i==null?void 0:i.selectedMenuState)==null?void 0:a.primaryMenuItem)==="workflow"&&((n=i==null?void 0:i.selectedMenuState)==null?void 0:n.stageId)===999?[{title:"WORKFLOW: CODECHECK",component:"CodecheckMetadataFormWrapper",props:{submission:o,canEdit:!0}}]:((l=i==null?void 0:i.selectedMenuState)==null?void 0:l.primaryMenuItem)==="workflow"&&((r=i==null?void 0:i.selectedMenuState)==null?void 0:r.stageId)===pkp.const.WORKFLOW_STAGE_ID_EXTERNAL_REVIEW&&(o!=null&&o.codecheckOptIn)?[...s,{component:"CodecheckReviewDisplay",props:{submission:o}}]:s})}),pkp.registry.storeExtend("fileManager_SUBMISSION_FILES",c=>{const t=c.store,s=pkp.registry.getPiniaStore("workflow"),i=s==null?void 0:s.submission;i!=null&&i.codecheckOptIn&&(t.extender.extendFn("getColumns",(o,a)=>{const n=[...o];return n.splice(n.length-1,0,{header:g("plugins.generic.codecheck.codecheckStatus"),component:"CodecheckFileStatus",props:{}}),n}),t.extender.extendFn("getItemActions",(o,a)=>a.file?[...o,{label:g("plugins.generic.codecheck.markAsOutput"),name:"markCodecheckOutput",icon:"CheckCircle",actionFn:({file:n})=>{const{useModal:l}=pkp.modules.useModal,{openDialog:r}=l(),{localize:d}=w();r({title:g("plugins.generic.codecheck.markAsOutputTitle"),message:g("plugins.generic.codecheck.markAsOutputConfirm",{fileName:d(n.name)}),actions:[{label:g("common.yes"),isPrimary:!0,callback:h=>{console.log("Marking file as CODECHECK output:",n),h()}},{label:g("common.no"),callback:h=>{h()}}]})}}]:o))}),window.addEventListener("DOMContentLoaded",()=>{setTimeout(()=>{ro()},1e3)});function ro(){var o,a,n,l;const c=(o=document.querySelector('textarea[name="manifestFiles"]'))==null?void 0:o.parentElement;if(c){const r=c.querySelector("textarea"),d=document.createElement("div");c.insertBefore(d,r),r.style.display="none",e.createApp(E,{name:"manifestFiles",label:"Expected Output Files",description:"List the main figures, tables, and results",value:r.value,isRequired:!0}).mount(d),d.addEventListener("update",h=>{r.value=h.detail,r.dispatchEvent(new Event("input",{bubbles:!0}))})}const t=(a=document.querySelector('textarea[name="codeRepository"]'))==null?void 0:a.parentElement;if(t){const r=t.querySelector("textarea"),d=document.createElement("div");t.insertBefore(d,r),r.style.display="none",e.createApp(_,{name:"codeRepository",label:"Code Repository URL(s)",description:"Link(s) to your code repository(ies)",value:r.value}).mount(d),d.addEventListener("update",h=>{r.value=h.detail,r.dispatchEvent(new Event("input",{bubbles:!0}))})}const s=(n=document.querySelector('textarea[name="dataRepository"]'))==null?void 0:n.parentElement;if(s){const r=s.querySelector("textarea"),d=document.createElement("div");s.insertBefore(d,r),r.style.display="none",e.createApp(_,{name:"dataRepository",label:"Data Repository URL(s)",description:"Link(s) to your data repository(ies)",value:r.value}).mount(d),d.addEventListener("update",h=>{r.value=h.detail,r.dispatchEvent(new Event("input",{bubbles:!0}))})}const i=(l=document.querySelector('textarea[name="retrieveReserveCertificateIdentifier"]'))==null?void 0:l.parentElement;if(i){const r=i.querySelector("textarea"),d=document.createElement("div");i.insertBefore(d,r),r.style.display="none",e.createApp(N,{name:"retrieveReserveCertificateIdentifier",label:"Certificate Identifier",description:"CODECHECK Certificate ID, Venue Type and Venue Name",value:r.value}).mount(d),d.addEventListener("update",h=>{r.value=h.detail,r.dispatchEvent(new Event("input",{bubbles:!0}))})}}const lo={template:`
    <pkp-table-cell>
      <span class="codecheck-status" :class="statusClass">{{ statusText }}</span>
    </pkp-table-cell>
  `,props:["file"],computed:{statusText(){return this.file.codecheckOutput?g("plugins.generic.codecheck.status.marked"):g("plugins.generic.codecheck.status.notMarked")},statusClass(){return this.file.codecheckOutput?"status-marked":"status-not-marked"}}};pkp.registry.registerComponent("CodecheckFileStatus",lo),console.log("CODECHECK plugin initialized successfully")})(pkp.modules.vue);
